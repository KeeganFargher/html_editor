<!-- 
Real-Time HTML Editor by @aaviator42
v1.0 : 2023-07-26
https://github.com/aaviator42/html_editor


Based on https://github.com/no-gravity/html_editor

Additions: dark mode for editor, resizable editor, tab char support
-->

<!DOCTYPE html>

<html>

	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="robots" content="noindex, nofollow, noarchive">
		<title>Real-Time HTML Editor</title>
	</head>

	<body>

		<style>

			html
			{
				height: 100%;
				padding: 0;
				margin: 0;
			}

			body
			{
				display: flex;
				flex-direction: column;
				height: 100%;
				padding: 0;
				margin: 0;
			}

			textarea
			{
				padding: 10px;
				resize: vertical;
				width: calc( 100% - 20px );
				height: 100%;
				margin: 0;
				border: 0;
				background-color: black;
				color: white;
				font-family: monospace;
				tab-size: 4;
			}

			textarea:focus
			{
				outline: none;
			}

			iframe
			{
				margin: 0;
				border: 0;
				height: 50%;
			}

			.controls
			{
				border-top   : 1px solid #808080;
				border-bottom: 1px solid #808080;
				padding: 4px;
				white-space: nowrap;
				overflow-x: auto;
				min-height: 23px;
			}

			.controls a, .controls label
			{
				text-decoration: none;
				color: #000000;
				user-select: none;
				padding: 8px;
				cursor: pointer;
			}

			.controls a:hover, .controls label:hover
			{
				background: #f0f0f0;
			}

		</style>

<textarea id=data><!doctype html>
<html>
	<body>

	<style>
		body {
			padding: 1rem;
		}
		span {
			display: inline-block;
			background: #a0ffa0;
			padding: 20px;
		}
	</style>

	<span>
	Edit the page on top, see 
	the result on the bottom.
	</span>

	</body>
</html></textarea>
  
		<div class=controls>
			<label>
				<input type=checkbox id=realtime onclick="update()" checked>
				realtime
			</label> | 
			<a href=# onClick="update()">update</a> |
			<a href=# onClick="goFullscreen(false)">fullscreen</a> |
			<a href=# onClick="goFullscreen(true)" >new fullscreen</a> |
			<a href="https://github.com/aaviator42/html_editor"
			   target=_blank>github</a>
		</div>
		<iframe name=hello style="width: 100%; height: 100%"></iframe>

		<script>

			function update()
			{
				let outty = window.hello.document;
				outty.open();
				let inny=document.getElementById("data");
				outty.write(inny.value);
				outty.close();
			};

			function goFullscreen(newWin)
			{
				if (newWin) outWin= window.open()
				else        outWin= window.open("about:blank","html_editor");
				outWin.focus();
				let outty = outWin.document;
				outty.open();
				let inny=document.getElementById("data");
				outty.write(inny.value);
				outty.close();
			}

			function realtime()
			{
				if (!document.querySelector("#realtime").checked) return;
				update();
			}

			dataArea=document.getElementById("data");
			dataArea.onkeyup=realtime;

			update();

		</script>
		<script>
		
			//for tab char support in textarea
			const textarea = document.getElementById('data');

			textarea.addEventListener('keydown', function(e) {
				if (e.key === 'Tab') {
					e.preventDefault();

					// Get the current cursor position
					const start = this.selectionStart;
					const end = this.selectionEnd;

					// Insert a tab character at the current position
					const tab = '\t';
					this.value = this.value.substring(0, start) + tab + this.value.substring(end);

					// Move the cursor to the new position after the tab
					this.selectionStart = this.selectionEnd = start + tab.length;
				}
			});
		</script>

	</body>
</html>
